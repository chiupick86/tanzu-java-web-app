accelerator:
  displayName: Tanzu Java Web App
  description: A sample Spring Boot web application built with Tanzu supply-chain
  iconUrl: https://raw.githubusercontent.com/sample-accelerators/icons/master/icon-cloud.png
  tags:
  - main-branch
  - java
  - spring
  - web
  - tanzu

  # options for the UI
  options:
  - name: workloadName
    label: "The Name of the Workload"
    inputType: text
    display: true
    defaultValue: ""
    required: true

  - name: textarea
    inputType: textarea
    display: true
    defaultValue: |
      Text line 1
      Text line 2

#   - name: javaVersion 
#     inputType: checkbox 
#     display: true 
#     dataType: [string]
#     defaultValue: 
#       - 17
#     choices:
#       - text: 16
#         value: '16'
#       - text: 17
#         value: '17' 
#       - text: 18
#         value: '18'

  - name: dependsOnCheckbox
    label: 'depends on checkbox'
    description: Visibility depends on the checkbox option containing exactly value value-2. 
    dependsOn:
      name: checkbox
      value: [value-2] 
    defaultValue: text value

  - name: javaVersion 
    inputType: select 
    display: true 
    defaultValue: value-2 
    choices:
      - text: 16
        value: '16'
      - text: 17
        value: '17'
      - text: 18
        value: '18'

  - name: radio 
    inputType: radio 
    display: true 
    defaultValue: value-2 
    choices:
      - text: Radio choice 1 
        value: value-1
      - text: Radio choice 2 
        value: value-2
      - text: Radio choice 3 
        value: value-3

engine:
  merge:
    - include: [ "**" ]
    - type: InvokeFragment
      reference: java-version
    - include: [ "**" ]
      exclude: [ "pom.xml", "config/**", "README.md"]
#     - include: [ "pom.xml" ]
#       chain:
#       - type: ReplaceText
#         substitutions:
#         - text: tanzu-java-web-app
#           with: "#workloadName"
#     - include: [ "config/workload.yaml" ]
#       chain:
#       - type: ReplaceText
#         substitutions:
#         - text: tanzu-java-web-app
#           with: "#workloadName"
    - include: [ "catalog-info.yaml" ]
      chain:
      - type: ReplaceText
        substitutions:
        - text: tanzu-java-web-app
          with: "#workloadName"
          
    - include: [ "config/workload.yaml" ]
      chain:
      - type: ReplaceText
        condition: "#javaVersion == '17'"
        substitutions:
          - text: "spec:"
            with: "'spec:\n  build:\n    env:\n    - name: BP_JVM_VERSION\n      value: \"17\"'"
